<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="åŒºå—é“¾," />










<meta name="description" content="ç®€ä»‹Truffleæ˜¯ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦çš„å¼€å‘ç¯å¢ƒï¼Œæµ‹è¯•æ¡†æ¶ï¼Œä»¥å¤ªåŠçš„èµ„æºç®¡ç†é€šé“ï¼Œè‡´åŠ›äºè®©ä»¥å¤ªåŠä¸Šçš„å¼€å‘å˜å¾—ç®€å•ã€‚ Truffleæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š å†…ç½®çš„æ™ºèƒ½åˆçº¦ç¼–è¯‘ï¼Œé“¾æ¥ï¼Œéƒ¨ç½²å’ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„ç®¡ç†ã€‚  å¿«é€Ÿå¼€å‘ä¸‹çš„è‡ªåŠ¨åˆçº¦æµ‹è¯•ã€‚  è„šæœ¬åŒ–çš„ï¼Œå¯æ‰©å±•çš„éƒ¨ç½²ä¸å‘å¸ƒæ¡†æ¶ã€‚  éƒ¨ç½²åˆ°ä¸ç®¡å¤šå°‘çš„å…¬ç½‘æˆ–ç§ç½‘çš„ç½‘ç»œç¯å¢ƒç®¡ç†åŠŸèƒ½  ä½¿ç”¨EthPM&amp;amp;NPMæä¾›çš„åŒ…ç®¡ç†ï¼Œä½¿ç”¨ERC190æ ‡å‡†ã€‚  ä¸åˆçº¦ç›´æ¥é€šä¿¡çš„ç›´æ¥">
<meta name="keywords" content="åŒºå—é“¾">
<meta property="og:type" content="article">
<meta property="og:title" content="truffle">
<meta property="og:url" content="http://yoursite.com/2017/11/22/truffle/index.html">
<meta property="og:site_name" content="æœ‰å¿—é’å¹´">
<meta property="og:description" content="ç®€ä»‹Truffleæ˜¯ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦çš„å¼€å‘ç¯å¢ƒï¼Œæµ‹è¯•æ¡†æ¶ï¼Œä»¥å¤ªåŠçš„èµ„æºç®¡ç†é€šé“ï¼Œè‡´åŠ›äºè®©ä»¥å¤ªåŠä¸Šçš„å¼€å‘å˜å¾—ç®€å•ã€‚ Truffleæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š å†…ç½®çš„æ™ºèƒ½åˆçº¦ç¼–è¯‘ï¼Œé“¾æ¥ï¼Œéƒ¨ç½²å’ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„ç®¡ç†ã€‚  å¿«é€Ÿå¼€å‘ä¸‹çš„è‡ªåŠ¨åˆçº¦æµ‹è¯•ã€‚  è„šæœ¬åŒ–çš„ï¼Œå¯æ‰©å±•çš„éƒ¨ç½²ä¸å‘å¸ƒæ¡†æ¶ã€‚  éƒ¨ç½²åˆ°ä¸ç®¡å¤šå°‘çš„å…¬ç½‘æˆ–ç§ç½‘çš„ç½‘ç»œç¯å¢ƒç®¡ç†åŠŸèƒ½  ä½¿ç”¨EthPM&amp;amp;NPMæä¾›çš„åŒ…ç®¡ç†ï¼Œä½¿ç”¨ERC190æ ‡å‡†ã€‚  ä¸åˆçº¦ç›´æ¥é€šä¿¡çš„ç›´æ¥">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/img/1524539079.png">
<meta property="og:updated_time" content="2018-04-24T03:49:24.084Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="truffle">
<meta name="twitter:description" content="ç®€ä»‹Truffleæ˜¯ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦çš„å¼€å‘ç¯å¢ƒï¼Œæµ‹è¯•æ¡†æ¶ï¼Œä»¥å¤ªåŠçš„èµ„æºç®¡ç†é€šé“ï¼Œè‡´åŠ›äºè®©ä»¥å¤ªåŠä¸Šçš„å¼€å‘å˜å¾—ç®€å•ã€‚ Truffleæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š å†…ç½®çš„æ™ºèƒ½åˆçº¦ç¼–è¯‘ï¼Œé“¾æ¥ï¼Œéƒ¨ç½²å’ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„ç®¡ç†ã€‚  å¿«é€Ÿå¼€å‘ä¸‹çš„è‡ªåŠ¨åˆçº¦æµ‹è¯•ã€‚  è„šæœ¬åŒ–çš„ï¼Œå¯æ‰©å±•çš„éƒ¨ç½²ä¸å‘å¸ƒæ¡†æ¶ã€‚  éƒ¨ç½²åˆ°ä¸ç®¡å¤šå°‘çš„å…¬ç½‘æˆ–ç§ç½‘çš„ç½‘ç»œç¯å¢ƒç®¡ç†åŠŸèƒ½  ä½¿ç”¨EthPM&amp;amp;NPMæä¾›çš„åŒ…ç®¡ç†ï¼Œä½¿ç”¨ERC190æ ‡å‡†ã€‚  ä¸åˆçº¦ç›´æ¥é€šä¿¡çš„ç›´æ¥">
<meta name="twitter:image" content="http://yoursite.com/img/1524539079.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/11/22/truffle/"/>





  <title>truffle | æœ‰å¿—é’å¹´</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">æœ‰å¿—é’å¹´</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/22/truffle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="leequer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æœ‰å¿—é’å¹´">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">truffle</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-11-22T22:00:00+08:00">
                2017-11-22
              </time>
            

           
          </span>

   

          
          
          
			&nbsp; | &nbsp;
			<span id="/2017/11/22/truffle/"class="leancloud_visitors" data-flag-title="truffle">
				&nbsp;é˜…è¯»æ¬¡æ•°
            </span>
          

          

         

        

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>Truffleæ˜¯ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦çš„å¼€å‘ç¯å¢ƒï¼Œæµ‹è¯•æ¡†æ¶ï¼Œä»¥å¤ªåŠçš„èµ„æºç®¡ç†é€šé“ï¼Œè‡´åŠ›äºè®©ä»¥å¤ªåŠä¸Šçš„å¼€å‘å˜å¾—ç®€å•ã€‚</p>
<h1 id="Truffleæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š"><a href="#Truffleæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š" class="headerlink" title="Truffleæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š"></a>Truffleæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</h1><ul>
<li>å†…ç½®çš„æ™ºèƒ½åˆçº¦ç¼–è¯‘ï¼Œé“¾æ¥ï¼Œéƒ¨ç½²å’ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„ç®¡ç†ã€‚ </li>
<li>å¿«é€Ÿå¼€å‘ä¸‹çš„è‡ªåŠ¨åˆçº¦æµ‹è¯•ã€‚ </li>
<li>è„šæœ¬åŒ–çš„ï¼Œå¯æ‰©å±•çš„éƒ¨ç½²ä¸å‘å¸ƒæ¡†æ¶ã€‚ </li>
<li>éƒ¨ç½²åˆ°ä¸ç®¡å¤šå°‘çš„å…¬ç½‘æˆ–ç§ç½‘çš„ç½‘ç»œç¯å¢ƒç®¡ç†åŠŸèƒ½ </li>
<li>ä½¿ç”¨EthPM&amp;NPMæä¾›çš„åŒ…ç®¡ç†ï¼Œä½¿ç”¨ERC190æ ‡å‡†ã€‚ </li>
<li>ä¸åˆçº¦ç›´æ¥é€šä¿¡çš„ç›´æ¥äº¤äº’æ§åˆ¶å°ï¼ˆå†™å®Œåˆçº¦å°±å¯ä»¥å‘½ä»¤è¡Œé‡ŒéªŒè¯äº†ï¼‰ã€‚</li>
<li>å¯é…çš„æ„å»ºæµç¨‹ï¼Œæ”¯æŒç´§å¯†é›†æˆã€‚</li>
<li>åœ¨Truffleç¯å¢ƒé‡Œæ”¯æŒæ‰§è¡Œå¤–éƒ¨çš„è„šæœ¬ã€‚</li>
</ul>
<h1 id="truffleä½¿ç”¨"><a href="#truffleä½¿ç”¨" class="headerlink" title="truffleä½¿ç”¨"></a>truffleä½¿ç”¨</h1><h2 id="å‰ç½®å·¥ä½œ"><a href="#å‰ç½®å·¥ä½œ" class="headerlink" title="å‰ç½®å·¥ä½œ"></a>å‰ç½®å·¥ä½œ</h2><h3 id="ç¯å¢ƒè¦æ±‚-NodeJS-5-0"><a href="#ç¯å¢ƒè¦æ±‚-NodeJS-5-0" class="headerlink" title="ç¯å¢ƒè¦æ±‚  NodeJS 5.0+"></a>ç¯å¢ƒè¦æ±‚  NodeJS 5.0+</h3><p>å…ˆå®‰è£…nodeï¼Œä¾æ¬¡æ‰§è¡Œä»¥ä¸‹2æ¡å‘½ä»¤ï¼š </p>
<pre><code>curl -sL https://deb.nodesource.com/setup_9.x 

sudo -E bash apt-get install nodejs
</code></pre><h3 id="truffleå®‰è£…"><a href="#truffleå®‰è£…" class="headerlink" title="truffleå®‰è£…"></a>truffleå®‰è£…</h3><p>å®‰è£…æ–¹å¼ï¼š </p>
<pre><code>$ npm install -g truffle
</code></pre><h3 id="TestRPCå®¢æˆ·ç«¯å®‰è£…"><a href="#TestRPCå®¢æˆ·ç«¯å®‰è£…" class="headerlink" title="TestRPCå®¢æˆ·ç«¯å®‰è£…"></a>TestRPCå®¢æˆ·ç«¯å®‰è£…</h3><p>Truffleéœ€è¦ä»¥å¤ªåŠå®¢æˆ·ç«¯ï¼Œéœ€è¦æ”¯æŒæ ‡å‡†çš„JSON RPC APIã€‚ç”¨æ™®é€šè¯è¯´å°±æ˜¯ éœ€è¦ä¸€ä¸ªå¯ä»¥è·‘åˆçº¦çš„ä»¥å¤ªåŠç§é“¾ã€‚å°±æ˜¯<a href="https://leequer.github.io/2017/11/01/%E4%BB%A5%E5%A4%AA%E5%9D%8A-%E7%A7%81%E6%9C%89%E9%93%BE%E7%9A%84%E5%AE%89%E8%A3%85%EF%BC%8C%E5%90%AF%E5%8A%A8%EF%BC%8C%E6%93%8D%E4%BD%9C/" title="ä»¥å¤ªåŠ-ç§æœ‰é“¾çš„å®‰è£…ï¼Œå¯åŠ¨ï¼Œæ“ä½œ" target="_blank" rel="noopener">ä»¥å¤ªåŠ-ç§æœ‰é“¾çš„å®‰è£…ï¼Œå¯åŠ¨ï¼Œæ“ä½œ</a>ä¸€æ–‡ä¸­æˆ‘ä»¬å»ºç«‹çš„ç§é“¾ï¼Œå¯åŠ¨è¿™ä¸ªç§é“¾ä¹Ÿå¯ä»¥ã€‚</p>
<p>å®‰è£…TestRPCä¸ºä¾‹: </p>
<pre><code>sudo -E npm install ethereumjs-testrpc -g
</code></pre><p>è¿è¡Œä¸‹é¢å‘½ä»¤å¯åŠ¨TestRPC</p>
<pre><code>testrpc
</code></pre><p>å¯çœ‹åˆ°testrpcç‰ˆæœ¬å·ã€åˆå§‹åŒ–ä»¥å¤ªåŠåœ°å€å’Œç›‘å¬ç«¯å£ï¼Œæ­¤å¤„ç‰ˆæœ¬å·ä¸ºv3.0.5</p>
<p>è¿è¡Œç»“æœï¼š</p>
<pre><code>root@blockchain:~$ testrpc Secp256k1 bindings are not compiled. Pure JS implementation will be used. EthereumJS TestRPC v3.0.5 Available 
Accounts ================== 
(0) 0x6f41fffc0338e715e8aac4851afc4079b712af70 ğŸ”’ 
(1) 0xad8926fdb14c2ca283ab1e8a05c0b6707bc03f97 ğŸ”’ 
(2) 0x1cb0ff92ec067169fd6b1b12c6d39a4f6c2cf6f9 ğŸ”’ 
(3) 0x594b70524993798cb093ca8a2bd7f02f904b66d3 ğŸ”’ 
(4) 0x2f1ee0930f00b0f3cdab66d916cbd1fa4fe9535a ğŸ”’ 
(5) 0x5513a551c5aafaa8719a0df5bf398d4b3af4e211 ğŸ”’ 
(6) 0xa1bf121993c23cc467eec8b7e453011dae250404 ğŸ”’ 
(7) 0xe0b161979ebca95235c4cfeddfd11fb30d782a4d ğŸ”’ 
(8) 0x093b30604ac41e054e71b670d8e3ab68360017c9 ğŸ”’ 
(9) 0x1cac60d851a44305d7dd6ecf8ff32f3403427d3d ğŸ”’ 
Private Keys ================== 
(0) db3ecbc77961edb030858411850bd1ed12915dcf3c13762ec3692989810c2870 
(1) e0cc6b69516123fdf5d739dc9109ab486cf385affba555f0f03a7c74d7c1a88f 
(2) cea171049aa817c8ecade84ed8d20ce9e2312bed6e0f39548c9673a65bd47a47 
(3) e7f5cbba7403d0c5ea421f6ce64165b79d5c13594ad4a0ffa27896b498d6f5ad 
(4) 6d1cd1fa965caf8a0b073faff072732de0eb0a8c153cc355f89eedb49c12ed12 
(5) c535a490deefd452daab45b01daaf34366d6748afa5f0778aac5dae6c590c135 
(6) 1292992fba6774016899237b8eb217108c5f9021e0e334aa5fad3db62e5c406b 
(7) 03d02b40ab919c9d51e26fdc2e70c221d65ec1970f1283acad8b3445c5771f56 
(8) 018069b07dc4d177a612ef0e20f63b9962781ab2d57d2ad50d9361a9be804bc4 
(9) cd348e9ee0bc2cfbda9b9822d42b3dd3b83d180425bc153ffbc7e7e5bf13fa28 
HD Wallet ================== 
Mnemonic: say slight close trip refuse seven marble fun edge galaxy cash pioneer Base HD Path: m/44&apos;/60&apos;/0&apos;/0/
Listening on localhost:8545
</code></pre><blockquote>
<p>8584 å°±æ˜¯rpcç«¯å£ï¼Œå°±æ˜¯åˆçº¦ç›‘å¬ç«¯å£ã€‚å¦‚æœæˆ‘ä»¬ä¸ç”¨testrpcï¼Œå¯åŠ¨è‡ªå·±çš„ç§é“¾ï¼Œé‚£ä¹ˆå¯åŠ¨å‘½ä»¤å°±è¦å¸¦è¿™ä¸ªâ€“rpcçš„å‚æ•°ï¼ŒæŒ‡å®šç«¯å£å·ã€‚å¦åˆ™åˆçº¦æ— æ³•ç¼–è¯‘ã€‚</p>
</blockquote>
<h2 id="truffleçš„ä½¿ç”¨å¹¶ç¼–è¯‘å’Œå‘å¸ƒåˆçº¦ï¼Œäº¤äº’åˆçº¦"><a href="#truffleçš„ä½¿ç”¨å¹¶ç¼–è¯‘å’Œå‘å¸ƒåˆçº¦ï¼Œäº¤äº’åˆçº¦" class="headerlink" title="truffleçš„ä½¿ç”¨å¹¶ç¼–è¯‘å’Œå‘å¸ƒåˆçº¦ï¼Œäº¤äº’åˆçº¦"></a>truffleçš„ä½¿ç”¨å¹¶ç¼–è¯‘å’Œå‘å¸ƒåˆçº¦ï¼Œäº¤äº’åˆçº¦</h2><h3 id="ç”¨truffleåˆ›å»ºé¡¹ç›®"><a href="#ç”¨truffleåˆ›å»ºé¡¹ç›®" class="headerlink" title="ç”¨truffleåˆ›å»ºé¡¹ç›®"></a>ç”¨truffleåˆ›å»ºé¡¹ç›®</h3><pre><code>$ mkdir -p /home/liqing/Documents/Ethereum/truffle/workspace/test1
</code></pre><h3 id="åˆå§‹åŒ–æ¡†æ¶"><a href="#åˆå§‹åŒ–æ¡†æ¶" class="headerlink" title="åˆå§‹åŒ–æ¡†æ¶"></a>åˆå§‹åŒ–æ¡†æ¶</h3><p>è¿›å…¥åˆ°å·¥ç¨‹æ ¹ç›®å½•ä¸‹(ç°åœ¨åº”è¯¥æ˜¯ä¸ªç©ºç›®å½•)ï¼Œå¹¶æ‰§è¡Œä¸‹è¿°å‘½ä»¤ã€‚<br>    $ cd /home/liqing/Documents/Ethereum/truffle/workspace/test1</p>
<pre><code>$ truffle init
</code></pre><p>æ­£ç¡®æ‰§è¡Œåï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸‹é¢è¿™æ ·çš„ç›®å½•ç»“æ„ï¼š</p>
<p><img src="/img/1524539079.png" alt=""></p>
<p>ç›®å½•ç»“æ„ç®€å•è¯´æ˜å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>contract/ - Truffleé»˜è®¤çš„åˆçº¦æ–‡ä»¶å­˜æ”¾åœ°å€ã€‚</p>
</li>
<li><p>migrations/ - å­˜æ”¾å‘å¸ƒè„šæœ¬æ–‡ä»¶</p>
</li>
<li><p>test/ - ç”¨æ¥æµ‹è¯•åº”ç”¨å’Œåˆçº¦çš„æµ‹è¯•æ–‡ä»¶</p>
</li>
<li><p>truffle.js - Truffleçš„é…ç½®æ–‡ä»¶</p>
</li>
</ul>
<h3 id="æ–°å»ºåˆçº¦"><a href="#æ–°å»ºåˆçº¦" class="headerlink" title="æ–°å»ºåˆçº¦"></a>æ–°å»ºåˆçº¦</h3><ul>
<li><p>åˆ é™¤./contractç›®å½•ä¸‹çš„è‡ªå¸¦demoåˆçº¦ï¼Œåˆ‡è®°ä¸è¦åˆ é™¤./contract/Migrations.solåˆçº¦ï¼Œå®ƒæ˜¯Truffleç”¨æ¥å¸®åŠ©éƒ¨ç½²çš„ã€‚</p>
<p>  $ cd /Users/admin/develop/blockchain_workspace/truffleTest/contracts</p>
</li>
<li><p>åœ¨./contractç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„åˆçº¦æ–‡Greeter.solã€‚</p>
<pre><code>pragma solidity ^0.4.0;
contract Greeter
{
address creator;
string greeting;
function Greeter(string _greeting) public
{
creator = msg.sender;
greeting = _greeting;
}
function greet() constant returns (string)
{
return greeting;
}
function setGreeting(string _newgreeting)
{
greeting = _newgreeting;
}
/**********
Standard kill() function to recover funds
**********/
function kill()
{
if (msg.sender == creator)
suicide(creator); // kills this contract and sends remaining funds back to creator
}
}
</code></pre></li>
</ul>
<h3 id="ä¿®æ”¹å‘å¸ƒè„šæœ¬"><a href="#ä¿®æ”¹å‘å¸ƒè„šæœ¬" class="headerlink" title="ä¿®æ”¹å‘å¸ƒè„šæœ¬"></a>ä¿®æ”¹å‘å¸ƒè„šæœ¬</h3><p>å°†./migrations/2_deploy_contracts.jsï¼ˆå¦‚æœæ²¡æœ‰æ–°å»ºä¸€ä¸ªï¼Œä¸è¦åŠ¨1_xxx.jsæ–‡ä»¶ï¼Œæ–‡ä»¶æ˜¯æŒ‰ç…§æ–‡ä»¶åç¼–å·é¡ºåºæ‰§è¡Œçš„ï¼‰ä¸‹çš„å†…å®¹ç”±ï¼š</p>
<pre><code>module.exports = function(deployer) 
{
    deployer.deploy(ConvertLib);
    deployer.autolink();
    deployer.deploy(MetaCoin);
};
</code></pre><p>ä¿®æ”¹ä¸ºï¼š</p>
<pre><code>var Greeter = artifacts.require(&quot;./Greeter.sol&quot;);
module.exports = function(deployer) {
    deployer.deploy(Greeter,&quot;hellow world!&quot;);
};
</code></pre><p>ç›®çš„æ˜¯å»æ‰åŸæœ‰è‡ªå¸¦çš„Demoéƒ¨ç½²æµç¨‹ï¼Œä¿®æ”¹ä¸ºè¦éƒ¨ç½²çš„åˆçº¦ã€‚ä¿®æ”¹å®Œåï¼Œè®°å¾—ä¿å­˜ï¼Œä¸ç„¶å‘å¸ƒæ—¶ä¼šæŠ¥é”™ï¼Œæ‰¾ä¸åˆ°ç›¸å…³åˆçº¦ã€‚</p>
<h3 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h3><p>è¿›å…¥åˆ°å·¥ç¨‹æ ¹ç›®å½•ä¸‹ï¼Œè¿›è¡Œç¼–è¯‘ï¼š</p>
<pre><code>$ truffle compile
Compiling Greeter.sol...
Writing artifacts to ./build/contracts
</code></pre><h3 id="éƒ¨ç½²åˆçº¦"><a href="#éƒ¨ç½²åˆçº¦" class="headerlink" title="éƒ¨ç½²åˆçº¦"></a>éƒ¨ç½²åˆçº¦</h3><p>éƒ¨ç½²åˆçº¦éœ€è¦æœ‰å¯åŠ¨çš„èŠ‚ç‚¹ï¼Œå¯ä»¥å¯åŠ¨ä½ çš„ç§é“¾ï¼Œä¹Ÿå¯ä»¥å¯åŠ¨æµ‹è¯•å®¢æˆ·ç«¯testrpc</p>
<ul>
<li>å¯åŠ¨ä½ çš„å®¢æˆ·ç«¯</li>
</ul>
<p>å¯åŠ¨ä¹‹å‰å®‰è£…å¥½çš„EthereumJS RPCå®¢æˆ·ç«¯ã€‚åˆšæ‰å¦‚æœå¯åŠ¨äº†å°±ä¸ç”¨ç®¡è¿™æ­¥äº†ã€‚</p>
<ul>
<li>éƒ¨ç½²åˆçº¦(migrate)</li>
</ul>
<p>ä¿®æ”¹ truffle.js çš„ç½‘ç»œè¿æ¥ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<pre><code>module.exports = {
    networks: {
        development: {
            host: &quot;localhost&quot;,
            port: 8545,
            network_id: &quot;*&quot; // åŒ¹é…ä»»ä½•network id
        }
    }
};
</code></pre><p>éƒ¨ç½²åˆçº¦åˆ°ç½‘ç»œä¸Šï¼š</p>
<pre><code>$ truffle migrate

Running migration: 2_deploy_contracts.js
Deploying Greeter...
Greeter: 0xe66038995cf64b14da96d26cbe1c96d30dec0e95
Saving successful migration to network...
Saving artifacts...
</code></pre><p>å¤‡æ³¨</p>
<p>ï‚· å¦‚æœæŠ¥é”™å‡ºç°äº†ä¸€äº›ä½ ä¹‹å‰ç¼–è¯‘éƒ¨ç½²è¿‡ï¼Œä½†ä½ å·²ç»ä¸éœ€è¦çš„åˆçº¦ï¼Œå¯ä»¥ç”¨truffle migrate â€“resetæ¥é‡ç½®éƒ¨ç½²ï¼Œä½†å¯èƒ½æ ¹æ®æƒ…å†µï¼Œä½ éœ€è¦æ›´æ–°ç§»æ¤ç‰ˆæœ¬å·ï¼Œæ¥ç®¡ç†ä¸åŒçš„ç‰ˆæœ¬ï¼Œ</p>
<h3 id="è¿è¡Œåˆçº¦"><a href="#è¿è¡Œåˆçº¦" class="headerlink" title="è¿è¡Œåˆçº¦"></a>è¿è¡Œåˆçº¦</h3><p>æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢å‘½ä»¤</p>
<pre><code>truffle console
</code></pre><p>åœ¨æ§åˆ¶å°ä¸åˆçº¦äº¤äº’ï¼Œæ‰§è¡Œåæ˜¾ç¤ºã€‚</p>
<pre><code>truffle(development)&gt; 
</code></pre><p>è¿™ä¸ªç ´æŠ˜å·åé¢å°±å¯ä»¥è¾“å…¥ä¸œè¥¿äº†</p>
<p>æˆ‘ä»¬è¾“å…¥</p>
<pre><code>Greeter.deployed().then(function(instance){cc= instance;});
</code></pre><ul>
<li><p>Greeteræ˜¯åˆçº¦çš„æ–‡ä»¶åä¹Ÿæ˜¯åˆçº¦åï¼Œåˆçº¦çš„åå­—å’Œåˆçº¦çš„æ–‡ä»¶åè¦ç›¸åŒå¦åˆ™</p>
<pre><code>ReferenceError: test is not defined
</code></pre></li>
<li><p>ä¸Šé¢çš„å‘½ä»¤æ„æ€æ˜¯Greeterè¿™ä¸ªåˆçº¦å·²ç»éƒ¨ç½²äº†ï¼Œç„¶åï¼Œå°†åˆçº¦å®ä¾‹èµ‹å€¼ç»™ccï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ccæ¥è°ƒç”¨åˆçº¦æ–¹æ³•äº†ã€‚</p>
</li>
<li><p>è°ƒç”¨åˆçº¦æ–¹æ³•,è¾“å…¥cc.  å¦‚æœä¸çŸ¥é“ä¼˜ä»€ä¹ˆæ–¹æ³•ï¼Œå¤šæŒ‰å‡ æ¬¡tabé”® å°±ä¼šå±•ç¤ºæ–¹æ³•ã€‚</p>
</li>
</ul>
<p>æˆ‘ä»¬æ‰§è¡Œgreetï¼ˆï¼‰æ–¹æ³•</p>
<pre><code>truffle(development)&gt; cc.greet();    
</code></pre><p>è¿”å›</p>
<pre><code>&apos;hellow world!&apos;
</code></pre><ul>
<li><p>æ§åˆ¶å°å†…ï¼Œå¯ä»¥é€šè¿‡å£°æ˜å˜é‡æ¥å‡å°‘è¾“å…¥çš„å†…å®¹ï¼Œæ¯”å¦‚</p>
<pre><code>var g = Greeter.deployed();g.greet();
</code></pre></li>
<li><p>é€€å‡ºç”¨ .exit</p>
</li>
</ul>
<h3 id="å¸¸è§æŠ¥é”™"><a href="#å¸¸è§æŠ¥é”™" class="headerlink" title="å¸¸è§æŠ¥é”™"></a>å¸¸è§æŠ¥é”™</h3><ul>
<li><p>ä»¥å¤ªåŠå®¢æˆ·ç«¯è¿æ¥é…ç½®ä¸æ­£ç¡®ï¼Œæˆ–æœªæ­£å¸¸å¯åŠ¨æ—¶ã€‚</p>
<pre><code>$ truffle console
/usr/local/lib/node_modules/truffle/lib/repl.js:25
if (err) return done(err);
^
ReferenceError: done is not defined
at /usr/local/lib/node_modules/truffle/lib/repl.js:25:21
at /usr/local/lib/node_modules/truffle/lib/repl.js:57:21
at /usr/local/lib/node_modules/truffle/lib/contracts.js:46:25
at /usr/local/lib/node_modules/truffle/node_modules/web3/lib/web3/property.js:119:13
at /usr/local/lib/node_modules/truffle/node_modules/web3/lib/web3/requestmanager.js:82:20
at exports.XMLHttpRequest.request.onreadystatechange (/usr/local/lib/node_modules/truffle/node_modules/web3/lib/web3/httppro
vider.js:114:13)
at exports.XMLHttpRequest.dispatchEvent (/usr/local/lib/node_modules/truffle/node_modules/xmlhttprequest/lib/XMLHttpRequest.
js:591:25)
at setState (/usr/local/lib/node_modules/truffle/node_modules/xmlhttprequest/lib/XMLHttpRequest.js:610:14)
at exports.XMLHttpRequest.handleError (/usr/local/lib/node_modules/truffle/node_modules/xmlhttprequest/lib/XMLHttpRequest.js
:532:5)
at ClientRequest.errorHandler (/usr/local/lib/node_modules/truffle/node_modules/xmlhttprequest/lib/XMLHttpRequest.js:459:14)
at emitOne (events.js:96:13)
at ClientRequest.emit (events.js:188:7)
at Socket.socketErrorListener (_http_client.js:309:9)
at emitOne (events.js:96:13)
at Socket.emit (events.js:188:7)
at emitErrorNT (net.js:1281:8)
</code></pre></li>
<li><p>è‹¥åˆçº¦æœªè¿›è¡Œéƒ¨ç½²å°±è¿›è¡Œè°ƒç”¨ï¼Œå¯èƒ½å‡ºç°ä¸‹è¿°æŠ¥é”™ï¼š</p>
<pre><code>truffle(default)&gt; Greeter.deployed().setGreeting(&quot;Hello world!&quot;);
Error: Cannot find deployed address: Greeter not deployed or address not set.
at Function.Contract.deployed (/Users/admin/develop/blockchain_workspace/truffleTest/build/contracts/Greeter.sol.js:311:1
3)
at evalmachine.&lt;anonymous&gt;:1:-53
at ContextifyScript.Script.runInContext (vm.js:37:29)
at Object.exports.runInContext (vm.js:69:17)
at TruffleInterpreter.interpret (/usr/local/lib/node_modules/truffle/lib/repl.js:99:17)
at bound (domain.js:280:14)
at REPLServer.runBound [as eval] (domain.js:293:12)
at REPLServer.onLine (repl.js:513:10)
at emitOne (events.js:96:13)
</code></pre></li>
</ul>
<p>##é—®é¢˜æ¥äº†</p>
<h3 id="é—®é¢˜1-æˆ‘å¦‚æœè¦éƒ¨ç½²ä¸¤ä¸ªåˆçº¦æ€ä¹ˆå¼„ï¼Ÿ"><a href="#é—®é¢˜1-æˆ‘å¦‚æœè¦éƒ¨ç½²ä¸¤ä¸ªåˆçº¦æ€ä¹ˆå¼„ï¼Ÿ" class="headerlink" title="é—®é¢˜1.æˆ‘å¦‚æœè¦éƒ¨ç½²ä¸¤ä¸ªåˆçº¦æ€ä¹ˆå¼„ï¼Ÿ"></a>é—®é¢˜1.æˆ‘å¦‚æœè¦éƒ¨ç½²ä¸¤ä¸ªåˆçº¦æ€ä¹ˆå¼„ï¼Ÿ</h3><ul>
<li>1.æŠŠåˆçº¦æ–‡ä»¶æ”¾åœ¨contractsæ–‡ä»¶å¤¹ä¸‹</li>
<li><p>2.ä¿®æ”¹2_deploy_contracts.js æ–‡ä»¶</p>
<pre><code>var Greeter = artifacts.require(&quot;./Greeter.sol&quot;);//ç¬¬ä¸€ä¸ªåˆçº¦
var test = artifacts.require(&quot;./DemoTypes.sol&quot;);//ç¬¬äºŒä¸ªåˆçº¦
module.exports = function(deployer) {
deployer.deploy(Greeter,&quot;hellow world!&quot;);
deployer.deploy(test);
};
</code></pre></li>
<li><p>3.æ‰§è¡Œç¼–è¯‘truffle compile</p>
</li>
<li><p>4.éƒ¨ç½² truffle migrate å‡ºç°äº†é—®é¢˜</p>
<pre><code>exceeds block gas limit
</code></pre><p>è¿™æ˜¯è¯´ä½ çš„åˆçº¦æ‰§è¡Œè¯è´¹å¤šä½™äº†ä½ å½“å‰è®¾ç½®çš„æœ€é«˜é™åº¦ï¼Œé‚£æˆ‘ä»¬è¦ä¿®æ”¹è¿™ä¸ªlimit </p>
<p>æ‰“å¼€truffle.js æ·»åŠ </p>
<pre><code>gas:4712388, //Gas limit used for deploys. Default is web3.eth.getBlock(â€œpendingâ€).gasLimit==4712388.
gasPrice:18000000000, //Gas price used for deploys. Default is 100000000000 (100 Shannon).
</code></pre><p>æ–‡ä»¶å˜ä¸º</p>
<pre><code>module.exports = {
  // See &lt;http://truffleframework.com/docs/advanced/configuration&gt;
  // to customize your Truffle configuration!
   networks: {
    development: {
    host: &quot;localhost&quot;,
    port: 8545,
        gas:4712388, //Gas limit used for deploys. Default is web3.eth.getBlock(â€œpendingâ€).gasLimit==4712388.
    gasPrice:18000000000, //Gas price used for deploys. Default is 100000000000 (100 Shannon).

    network_id: &quot;*&quot; // åŒ¹é…ä»»ä½•network id
    }
}
};
</code></pre><p>æˆ‘ä»¬é‡æ–°è®¾ç½®äº†gasèŠ±è´¹ä¸Šé™</p>
<p>è¿™æ ·å°±å¯ä»¥äº†ã€‚åé¢å°±æ²¡æœ‰é—®é¢˜äº†ã€‚</p>
</li>
</ul>
<h3 id="é—®é¢˜2ï¼šä¸ºä»€ä¹ˆæˆ‘çš„åˆçº¦éƒ¨ç½²ä¸€ç›´åœåœ¨é‚£é‡Œï¼Ÿ"><a href="#é—®é¢˜2ï¼šä¸ºä»€ä¹ˆæˆ‘çš„åˆçº¦éƒ¨ç½²ä¸€ç›´åœåœ¨é‚£é‡Œï¼Ÿ" class="headerlink" title="é—®é¢˜2ï¼šä¸ºä»€ä¹ˆæˆ‘çš„åˆçº¦éƒ¨ç½²ä¸€ç›´åœåœ¨é‚£é‡Œï¼Ÿ"></a>é—®é¢˜2ï¼šä¸ºä»€ä¹ˆæˆ‘çš„åˆçº¦éƒ¨ç½²ä¸€ç›´åœåœ¨é‚£é‡Œï¼Ÿ</h3><p>é‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œå¤šåŠæ˜¯ä½ æ²¡æœ‰ç”¨testrcpï¼Œæ¢æˆäº†è‡ªå·±çš„ç§é“¾ï¼Œè€Œå’Œtestrcpç›¸æ¯”ï¼Œtestrcpæ˜¯è‡ªåŠ¨æŒ–çŸ¿çš„ï¼Œå¦‚ä½ å¼€å¯äº†è‡ªå·±çš„ç§é“¾ï¼Œä½†æ²¡æœ‰æŒ–çŸ¿ï¼Œé‚£ä¹ˆä½ çš„åˆçº¦éƒ¨ç½²æ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œæ‰€ä»¥è§£å†³æ–¹æ³•å°±æ˜¯ï¼Œå¼€å¯ä½ ç§é“¾çš„æŒ–çŸ¿ã€‚miner.start()</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/åŒºå—é“¾/" rel="tag"># åŒºå—é“¾</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/11/21/truffleä½¿ç”¨/" rel="next" title="truffleä½¿ç”¨">
                <i class="fa fa-chevron-left"></i> truffleä½¿ç”¨
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/04/23/solidityåŸºç¡€- ä¸€è¡Œä»£ç è’¸å‘äº†Â¥6,447,277,680 äººæ°‘å¸ï¼/" rel="prev" title="solidityåŸºç¡€- ä¸€è¡Œä»£ç è’¸å‘äº†Â¥6,447,277,680 äººæ°‘å¸ï¼">
                solidityåŸºç¡€- ä¸€è¡Œä»£ç è’¸å‘äº†Â¥6,447,277,680 äººæ°‘å¸ï¼ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zMzI0Mi85Nzk5"></div>
    </div>

  
  


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">leequer</p>
              <p class="site-description motion-element" itemprop="description">æˆ‘ä¸æ˜¯èƒ–ï¼Œåªæ˜¯è‚‰æœ‰ç‚¹å¤š</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">79</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">23</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/leequer" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:447476554@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ç®€ä»‹"><span class="nav-number">1.</span> <span class="nav-text">ç®€ä»‹</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Truffleæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š"><span class="nav-number">2.</span> <span class="nav-text">Truffleæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#truffleä½¿ç”¨"><span class="nav-number">3.</span> <span class="nav-text">truffleä½¿ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#å‰ç½®å·¥ä½œ"><span class="nav-number">3.1.</span> <span class="nav-text">å‰ç½®å·¥ä½œ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¯å¢ƒè¦æ±‚-NodeJS-5-0"><span class="nav-number">3.1.1.</span> <span class="nav-text">ç¯å¢ƒè¦æ±‚  NodeJS 5.0+</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#truffleå®‰è£…"><span class="nav-number">3.1.2.</span> <span class="nav-text">truffleå®‰è£…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TestRPCå®¢æˆ·ç«¯å®‰è£…"><span class="nav-number">3.1.3.</span> <span class="nav-text">TestRPCå®¢æˆ·ç«¯å®‰è£…</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#truffleçš„ä½¿ç”¨å¹¶ç¼–è¯‘å’Œå‘å¸ƒåˆçº¦ï¼Œäº¤äº’åˆçº¦"><span class="nav-number">3.2.</span> <span class="nav-text">truffleçš„ä½¿ç”¨å¹¶ç¼–è¯‘å’Œå‘å¸ƒåˆçº¦ï¼Œäº¤äº’åˆçº¦</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç”¨truffleåˆ›å»ºé¡¹ç›®"><span class="nav-number">3.2.1.</span> <span class="nav-text">ç”¨truffleåˆ›å»ºé¡¹ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆå§‹åŒ–æ¡†æ¶"><span class="nav-number">3.2.2.</span> <span class="nav-text">åˆå§‹åŒ–æ¡†æ¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ–°å»ºåˆçº¦"><span class="nav-number">3.2.3.</span> <span class="nav-text">æ–°å»ºåˆçº¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¿®æ”¹å‘å¸ƒè„šæœ¬"><span class="nav-number">3.2.4.</span> <span class="nav-text">ä¿®æ”¹å‘å¸ƒè„šæœ¬</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¼–è¯‘"><span class="nav-number">3.2.5.</span> <span class="nav-text">ç¼–è¯‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#éƒ¨ç½²åˆçº¦"><span class="nav-number">3.2.6.</span> <span class="nav-text">éƒ¨ç½²åˆçº¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿è¡Œåˆçº¦"><span class="nav-number">3.2.7.</span> <span class="nav-text">è¿è¡Œåˆçº¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¸¸è§æŠ¥é”™"><span class="nav-number">3.2.8.</span> <span class="nav-text">å¸¸è§æŠ¥é”™</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#é—®é¢˜1-æˆ‘å¦‚æœè¦éƒ¨ç½²ä¸¤ä¸ªåˆçº¦æ€ä¹ˆå¼„ï¼Ÿ"><span class="nav-number">3.2.9.</span> <span class="nav-text">é—®é¢˜1.æˆ‘å¦‚æœè¦éƒ¨ç½²ä¸¤ä¸ªåˆçº¦æ€ä¹ˆå¼„ï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#é—®é¢˜2ï¼šä¸ºä»€ä¹ˆæˆ‘çš„åˆçº¦éƒ¨ç½²ä¸€ç›´åœåœ¨é‚£é‡Œï¼Ÿ"><span class="nav-number">3.2.10.</span> <span class="nav-text">é—®é¢˜2ï¼šä¸ºä»€ä¹ˆæˆ‘çš„åˆçº¦éƒ¨ç½²ä¸€ç›´åœåœ¨é‚£é‡Œï¼Ÿ</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">leequer</span>

  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>
  <span id="busuanzi_container_site_pv">
    æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡
  </span>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    

    
      <script type="text/javascript">
      function renderGitment(){
        var gitment = new Gitmint({
            id: window.location.pathname, 
            owner: 'leequer',
            repo: 'https://github.com/leequer/leequer.github.io.git',
            
            lang: "" || navigator.language || navigator.systemLanguage || navigator.userLanguage,
            
            oauth: {
            
            
                client_secret: '41d0c9bb7796c7728c1e23a7af8bde9c0487ed49',
            
                client_id: '19e9892b4e6b7eb2ccf5'
            }});
        gitment.render('gitment-container');
      }

      
      function showGitment(){
        document.getElementById("gitment-display-button").style.display = "none";
        document.getElementById("gitment-container").style.display = "block";
        renderGitment();
      }
      
      </script>
    







  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("g6QTkM1EHRvlyWzXA7Uj9P6u-gzGzoHsz", "u7DkS9lXJisLp5VBDIleP8c1");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

  
		<script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
<script>AV.initialize("g6QTkM1EHRvlyWzXA7Uj9P6u-gzGzoHsz", "u7DkS9lXJisLp5VBDIleP8c1");</script>
<script>
function showTime(Counter) {
	var query = new AV.Query(Counter);
	$(".leancloud_visitors").each(function() {
		var url = $(this).attr("id").trim();
		query.equalTo("url", url);
		query.find({
			success: function(results) {
				if (results.length == 0) {
					var content = '0 ' + $(document.getElementById(url)).text();
					$(document.getElementById(url)).text(content);
					return;
				}
				for (var i = 0; i < results.length; i++) {
					var object = results[i];
					var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
					$(document.getElementById(url)).text(content);
				}
			},
			error: function(object, error) {
				console.log("Error: " + error.code + " " + error.message);
			}
		});

	});
}

function addCount(Counter) {
	var Counter = AV.Object.extend("Counter");
	url = $(".leancloud_visitors").attr('id').trim();
	title = $(".leancloud_visitors").attr('data-flag-title').trim();
	var query = new AV.Query(Counter);
	query.equalTo("url", url);
	query.find({
		success: function(results) {
			if (results.length > 0) {
				var counter = results[0];
				counter.fetchWhenSave(true);
				counter.increment("time");
				counter.save(null, {
					success: function(counter) {
						var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
					},
					error: function(counter, error) {
						console.log('Failed to save Visitor num, with error message: ' + error.message);
					}
				});
			} else {
				var newcounter = new Counter();
				newcounter.set("title", title);
				newcounter.set("url", url);
				newcounter.set("time", 1);
				newcounter.save(null, {
					success: function(newcounter) {
					    console.log("newcounter.get('time')="+newcounter.get('time'));
						var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
					},
					error: function(newcounter, error) {
						console.log('Failed to create');
					}
				});
			}
		},
		error: function(error) {
			console.log('Error:' + error.code + " " + error.message);
		}
	});
}
$(function() {
	var Counter = AV.Object.extend("Counter");
	if ($('.leancloud_visitors').length == 1) {
		addCount(Counter);
	} else if ($('.post-title-link').length > 1) {
		showTime(Counter);
	}
}); 
</script>
  
</body>
</html>
